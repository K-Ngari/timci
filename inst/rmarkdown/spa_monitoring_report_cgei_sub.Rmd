---
title: "SPA monitoring report - Caregiver exit interview subsection"
author: "H. LANGET"
date: "2021-12-22"
output: pdf_document
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE)
```

# Caregiver exit interview

```{r, results='asis'}
cat(ch_title2)

timci::generate_calendar_heatmap2(spa_cgei_data,
                                  date,
                                  legendtitle = "Number of submissions")
```

```{r, results = "asis"}
all <- spa_cgei_data %>% 
  rename(referral = "g5-i4_1",
         facility_name = "fname")

summary <- list(
  "Summary" = list(
    "Yes" = ~qwraps2::n_perc(referral == 1, prec),
    "No" = ~qwraps2::n_perc(referral == 0, prec),
    "Not sure" = ~qwraps2::n_perc(referral == 98, prec),
    "Declined" = ~qwraps2::n_perc(referral == 97, prec)
    )
)
out <- format_summary_table(all, summary, facility_name)
out %>% 
  kableExtra::kbl(booktabs = TRUE,
                  linesep = "",
                  align = c("c", "c", "c", "c"),
                  caption = "Referral") %>% 
  kableExtra::kable_styling(latex_options = c("HOLD_position", "repeat_header"), font_size = table_fs) %>%
  kableExtra::row_spec(0, bold = TRUE) %>%
  kableExtra::row_spec(1, color = total_row_ft2, background = total_row_bg2, bold = TRUE) %>%
  kableExtra::row_spec(1:(nrow(out)/2) * 2, background = striped_row_bg)
```
